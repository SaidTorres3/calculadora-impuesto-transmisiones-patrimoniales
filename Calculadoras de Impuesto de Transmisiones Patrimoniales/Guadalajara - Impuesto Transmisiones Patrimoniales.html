<html>

<head>
  <style>
    body {
      color: white;
      background-color: black;
      align-items: center;
      text-align: center;
      padding-top: 20px;
      font-family: Calibri;
    }

    button {
      transition-duration: 0.5s;
    }

    button:hover {
      background-color: rgb(15, 163, 189);
      transform: scale(0.9);
    }

    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type=number] {
      -moz-appearance: textfield;
    }

  </style>
  <title>Calculadora de Impuesto | Transmisiones Patrimoniales - Guadalajara</title>
</head>

<body>
  <h1>Calculadora de impuesto sobre transmisiones patrimoniales  - Guadalajara</h1>
  <input style="height: 100px; width: 500px; font-size: 30px; text-align: center; padding: 0px; margin: 0;" id="input"
    type="number" title="Ingrese la cantidad que desea calcular su impuesto" onkeyup="activadoraTecla(event)"></input>
  <button style="height: 100px; width: 300px; font-size: 30px;" id="boton">Obtener resultado</button>

  <div id="output"></div>

  <script>


    function calculadoraDeImpuestos(a) {

      let resultado;

      if (a >= 0.01 && a <= 337050) {
        resultado = ((a-0.01)*0.025)+0
      }

      if (a >= 337050.01 && a <= 776142.90) {
        resultado = ((a-337050.01)*0.026)+8426.25
      }

      if (a >= 776142.91 && a <= 1053400.41) {
        resultado = ((a-776142.91)*0.027)+19842.66
      }

      if (a >= 1053400.42 && a <= 1325856.37) {
        resultado = ((a-1053400.42)*0.028)+27328.62
      }

      if (a >= 1325856.38 && a <= 1668739.75) {
        resultado = ((a-1325856.38)*0.029)+34957.38
      }
      
      if (a >= 1668739.76 && a <= 2188818.99) {
        resultado = ((a-1668739.76)*0.03)+44901
      }

      if (a >= 2188819 && a <= 3146685.51) {
        resultado = ((a-2188819)*0.031)+60503.38
      }

      if (a >= 3146685.52 && a <= 4944269.46) {
        resultado = ((a-3000000.01)*0.032)+90197.24
      }

      if (a >= 4944269.47 && a <= 9858156.01) {
        resultado = ((a-4944269.47)*0.033)+147719.93
      }

      if (a >= 9858156.02 && a <= 42976151.21) {
        resultado = ((a-9858156.02)*0.034)+309878.18
      }

      if (a >= 42976151.22) {
        resultado = ((a-42976151.22)*0.035)+1435890.02
      }

      return resultado;
    }

    function addCommas(nStr) {
      nStr += '';
      var x = nStr.split('.');
      var x1 = x[0];
      var x2 = x.length > 1 ? '.' + x[1] : '';
      var rgx = /(\d+)(\d{3})/;
      while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
      }
      return x1 + x2;
    }


    function activadora() {
      let input = parseFloat(document.getElementById("input").value)

      let resultado = (calculadoraDeImpuestos(input)).toFixed(2)

      console.log(`${input} ===> ${resultado}`)
      output.innerHTML = `<br><br /><button href="#" style="font-size: 30px;" title="Click para copiar la cantidad al portapapeles." onclick="copiarAlPortapapeles()">Impuesto a pagar: <p onclick="copiarAlPortapapeles()" id="resultado">${resultado}</p></button>
      <br /> <h2>Cantidad ingresada: ${addCommas(input)} / Resultado: ${addCommas(resultado)}</h2>
      `
    }

    function activadoraTecla(event) {

      var keycode = event.keyCode
      if (keycode == '13') {
        activadora()
      }
    }

    function copiarAlPortapapeles() {
      let aux = document.createElement("input");
      aux.setAttribute("value", document.getElementById("resultado").innerHTML);
      document.body.appendChild(aux);
      aux.select();
      document.execCommand("copy");
      document.body.removeChild(aux);
    }

    document.getElementById('input').addEventListener('keydown', function(e) {
        if (e.which === 38 || e.which === 40) {
          e.preventDefault();
        }
    });

    //Codigo normal

    var boton = document.getElementById("boton")
    var output = document.getElementById("output")
    var resultado = document.getElementById("resultado")

    boton.addEventListener("click", activadora)
    // resultado.addEventListener("click", copiarAlPortapapeles)

  </script>
</body>
<footer>
  <br />
  <img src="https://i.imgur.com/CwBfgMi.png" alt="f4">
  <h5>Nota: Puede checar el historial de conversiones presinando la tecla F12 (Si est√° en Chrome).</h5>
</footer>

</html>