<html>

<head>
  <style>
    body {
      color: white;
      background-color: black;
      align-items: center;
      text-align: center;
      padding-top: 20px;
      font-family: Calibri;
    }

    button {
      transition-duration: 0.5s;
    }

    button:hover {
      background-color: rgb(15, 163, 189);
      transform: scale(0.9);
    }

    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type=number] {
      -moz-appearance: textfield;
    }

  </style>
  <title>Calculadora de Impuesto | Transmisiones Patrimoniales - Puerto Vallarta</title>
</head>

<body>
  <h1>Calculadora de impuesto sobre transmisiones patrimoniales  - Puerto Vallarta</h1>
  <input style="height: 100px; width: 500px; font-size: 30px; text-align: center; padding: 0px; margin: 0;" id="input"
    type="number" title="Ingrese la cantidad que desea calcular su impuesto" onkeyup="activadoraTecla(event)"></input>
  <button style="height: 100px; width: 300px; font-size: 30px;" id="boton">Obtener resultado</button>

  <div id="output"></div>

  <script>


    function calculadoraDeImpuestos(a) {

      let resultado;

      if (a >= 0.01 && a <= 300000) {
        resultado = ((a-0.01)*0.02)+0
      }

      if (a >= 300000.01 && a <= 500000) {
        resultado = ((a-300000.01)*0.0205)+6000
      }

      if (a >= 500000.01 && a <= 1000000) {
        resultado = ((a-500000.01)*0.021)+10100
      }

      if (a >= 1000000.01 && a <= 1500000) {
        resultado = ((a-1000000.01)*0.0215)+20600
      }

      if (a >= 1500000.01 && a <= 2000000) {
        resultado = ((a-1500000.01)*0.022)+31350
      }
      
      if (a >= 2000000.01 && a <= 2500000) {
        resultado = ((a-2000000.01)*0.027)+42350
      }

      if (a >= 2500000.01 && a <= 3000000) {
        resultado = ((a-2500000.01)*0.028)+55850
      }

      if (a >= 3000000.01 && a <= 4000000) {
        resultado = ((a-3000000.01)*0.029)+69850
      }

      if (a >= 4000000.01 && a <= 5000000) {
        resultado = ((a-4000000.01)*0.03)+98850
      }

      if (a >= 5000000.01) {
        resultado = ((a-5000000.01)*0.031)+128850
      }

      return resultado;
    }

    function addCommas(nStr) {
      nStr += '';
      var x = nStr.split('.');
      var x1 = x[0];
      var x2 = x.length > 1 ? '.' + x[1] : '';
      var rgx = /(\d+)(\d{3})/;
      while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
      }
      return x1 + x2;
    }


    function activadora() {
      let input = parseFloat(document.getElementById("input").value)

      let resultado = (calculadoraDeImpuestos(input)).toFixed(2)

      console.log(`${input} ===> ${resultado}`)
      output.innerHTML = `<br><br /><button href="#" style="font-size: 30px;" title="Click para copiar la cantidad al portapapeles." onclick="copiarAlPortapapeles()">Impuesto a pagar: <p onclick="copiarAlPortapapeles()" id="resultado">${resultado}</p></button>
      <br /> <h2>Cantidad ingresada: ${addCommas(input)} / Resultado: ${addCommas(resultado)}</h2>
      `
    }

    function activadoraTecla(event) {

      var keycode = event.keyCode
      if (keycode == '13') {
        activadora()
      }
    }

    function copiarAlPortapapeles() {
      let aux = document.createElement("input");
      aux.setAttribute("value", document.getElementById("resultado").innerHTML);
      document.body.appendChild(aux);
      aux.select();
      document.execCommand("copy");
      document.body.removeChild(aux);
    }

    document.getElementById('input').addEventListener('keydown', function(e) {
        if (e.which === 38 || e.which === 40) {
          e.preventDefault();
        }
    });

    //Codigo normal

    var boton = document.getElementById("boton")
    var output = document.getElementById("output")
    var resultado = document.getElementById("resultado")

    boton.addEventListener("click", activadora)
    // resultado.addEventListener("click", copiarAlPortapapeles)

  </script>
</body>
<footer>
  <br />
  <img src="https://i.imgur.com/QMhKL0W.png" alt="f4">
  <h5>Nota: Puede checar el historial de conversiones presinando la tecla F12 (Si est√° en Chrome).</h5>
</footer>

</html>