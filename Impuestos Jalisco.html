<html>

<head>
  <style>
    body {
      color: white;
      background-color: black;
      align-items: center;
      text-align: center;
      padding-top: 20px;
      font-family: Calibri;
    }

    button:hover {
      background-color: blue;
    }

    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type=number] {

      -moz-appearance: textfield;

    }
  </style>
  <title>Calculadora de Impuestos - Jalisco</title>
</head>

<body>
  <h1>Calculadora de impuestos - Jalisco</h1>
  <input style="height: 100px; width: 500px; font-size: 30px; text-align: center; padding: 0px; margin: 0;" id="input"
    type="number" title="Ingrese la cantidad que desea calcular su impuesto" onkeyup="activadoraTecla(event)"></input>
  <button style="height: 100px; width: 300px; font-size: 30px;" id="boton">Obtener resultado</button>

  <div id="output"></div>

  <script>


    function calculadoraDeImpuestos(a) {

      let resultado;

      if (a >= 0.1 && a <= 61500) {
        resultado = (a * 0.02)
      }

      if (a >= 61500.01 && a <= 127500) {
        resultado = (a * 0.045) + 1230
      }

      if (a >= 127500.01 && a <= 174800) {
        resultado = (a * 0.069) + 4200
      }

      if (a >= 174800.01 && a <= 222200) {
        resultado = (a * 0.07) + 7463.7
      }

      if (a >= 222200.01) {
        resultado = (a * 0.071) + 10781.7
      }

      return resultado;
    }

    function addCommas(nStr) {
      nStr += '';
      var x = nStr.split('.');
      var x1 = x[0];
      var x2 = x.length > 1 ? '.' + x[1] : '';
      var rgx = /(\d+)(\d{3})/;
      while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
      }
      return x1 + x2;
    }


    function activadora() {
      let input = parseFloat(document.getElementById("input").value)

      let resultado = (calculadoraDeImpuestos(input)).toFixed(2)

      console.log(resultado)
      output.innerHTML = `<br><br /><button href="#" style="font-size: 30px;" title="Click para copiar la cantidad al portapapeles." onclick="copiarAlPortapapeles()">Impuestos a pagar: <p onclick="copiarAlPortapapeles()" id="resultado">${resultado}</p></button>
      <br /> <h3>Cantidad ingresada: ${addCommas(input)} / Resultado: ${addCommas(resultado)}</h3>
      `
    }

    function activadoraTecla(event) {

      var keycode = event.keyCode
      if (keycode == '13') {
        activadora()
      }
    }

    function copiarAlPortapapeles() {
      let aux = document.createElement("input");
      aux.setAttribute("value", document.getElementById("resultado").innerHTML);
      document.body.appendChild(aux);
      aux.select();
      document.execCommand("copy");
      document.body.removeChild(aux);
    }

    //Codigo normal

    var boton = document.getElementById("boton")
    var output = document.getElementById("output")
    var resultado = document.getElementById("resultado")

    boton.addEventListener("click", activadora)
    // resultado.addEventListener("click", copiarAlPortapapeles)

  </script>
</body>

</html>